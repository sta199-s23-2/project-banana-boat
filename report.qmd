---
title: "Banana Boat STA 199 Project"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

**Introduction & Data**

This data set comes from the CORGIS Dataset Project, who got this data from the US Energy Information Administration, a part of the US Government. This data has been collected by the US Energy Information Administration from 1960 to 2019 based on the consumption, production, expenditures, and price of different sources of energy by state.

The observations are of different states in different years and have variables for many energy sources, including coal, kerosene, geothermal, hydro, etc. There are also different variables for the production, consumption, expenditure, and price of these types of energy. For some of these, information was not available, in which case a 0 was reported.

There should be no ethical concerns about the data since the data is not specific to individuals and reports many types of used energy in the US.

*Research question: On both a state and national level, how has the proportion of renewable energy usage/production relative to overall energy usage/production changed over time, and has there been a shift in which states are the most renewable energy heavy?*

As climate change continues to progress rapidly, it is important to move towards clean technology and renewable energy sources in order to save our earth while ensuring innovation. The United States of America has emerged as a leading renewable energy innovator in the world, which is a perfect study target for researchers who are interested in the implementation of renewable energy. Our team thinks that analyzing the energy usage of different states is a good way to see how our country is progressing toward the goal of slowing global warming on a local level. This research method will help policymakers and environmental engineers pinpoint the specific problems regarding renewable energy in our country and help us move towards a clean future of collaboration of all states.

States that have higher emphasis on technological advancement such as California and North Carolina will see a significant increase in renewable energy production and consumption.

Important definitions: The data set contains both categorical and quantitative variables. The categorical variables include "State". The remaining columns, focusing on relevant facts regarding different uses of energy, are all quantitative.

Renewable energy: For our project, energy is considered renewable if it meets two criteria. First, the energy must be derived from a naturally occurring source. Additionally, the energy is naturally replenished at a higher rate than it is consumed/used.

Other energy sources: natural gas, coal, as well as any other sources of energy.

Groups of interest: states, expenditures and consumption of renewable energy and other energy sources, etc. Our goal is to study the effects of these aforementioned variables to learn about consumption habits and technological specialization of different states.

**Methodology**

```{r}
library(tidyverse)
data <- read_csv("~/project-banana-boat/data/energy.csv")
```

Creating variables total energy, total renewable energy, and proportion of renewable energy consumption:

```{r}
data <- data |>
  mutate(total_energy = Consumption.Commercial.Coal + 
                        `Consumption.Commercial.Distillate Fuel Oil` +
                        Consumption.Commercial.Geothermal +
                        Consumption.Commercial.Hydropower +
                        Consumption.Commercial.Kerosene +
                        Consumption.Commercial.Petroleum +
                        `Consumption.Commercial.Natural Gas` +
                        Consumption.Commercial.Solar +
                        Consumption.Commercial.Wind +
                        `Consumption.Electric Power.Coal` +
                        `Consumption.Electric Power.Distillate Fuel Oil` +
                        `Consumption.Electric Power.Natural Gas` +
                        Consumption.Industrial.Coal +
                        `Consumption.Industrial.Distillate Fuel Oil` +
                         Consumption.Industrial.Geothermal +
                         Consumption.Industrial.Hydropower +
                         Consumption.Industrial.Kerosene +
                         Consumption.Industrial.Petroleum +
                         `Consumption.Industrial.Natural Gas` +
                         `Consumption.Industrial.Other Petroleum Products` +
                         Consumption.Industrial.Solar +
                         Consumption.Industrial.Wind +
                         Consumption.Refinery.Coal +
                         Consumption.Refinery.Coal +
                         `Consumption.Residential.Distillate Fuel Oil` +
                         Consumption.Residential.Geothermal +
                         Consumption.Residential.Kerosene +
                         Consumption.Residential.Petroleum +
                         `Consumption.Residential.Natural Gas` +
                         Consumption.Transportation.Coal +
                         `Consumption.Transportation.Distillate Fuel Oil` +
                         Consumption.Transportation.Petroleum +
                         `Consumption.Transportation.Natural Gas`,
         .after = Year) |>
  mutate(total_renewable = Consumption.Commercial.Geothermal +
                           Consumption.Commercial.Hydropower +
                           Consumption.Commercial.Solar +
                           Consumption.Commercial.Wind +
                           Consumption.Industrial.Geothermal +
                           Consumption.Industrial.Hydropower +
                           Consumption.Industrial.Solar +
                           Consumption.Industrial.Wind +
                           Consumption.Residential.Geothermal,
         .after = total_energy) |>
  mutate(prop_renewable = (total_renewable / total_energy),
          .after = total_renewable)

```

Calculate total proportions for all states per year:

```{r}
national_renewable_usage <- data |>
  group_by(Year) |>
  summarize(total_energy_all_states = sum(total_energy),
            renewable_energy_all_states = sum(total_renewable)) |>
  mutate(prop_renewable_all_states = (renewable_energy_all_states / 
                                          total_energy_all_states))

```

graph national usage of renewable energy:

```{r}
national_renewable_usage |>
  ggplot(aes(x = Year, y = prop_renewable_all_states)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  labs(title = "National Renewable Consumption over Time",
       y = "Proportion of Renewable Energy Consumption")

```

Here, we use a dot plot to demonstrate the change over time of renewable consumption. Additionally, we added a line of best fit in order to best see how the consumption changed over time.

Energy proportion for top 5 states in 2019:

```{r}
data |>
  filter(Year == 2019) |>
  arrange(desc(prop_renewable)) |>
  slice(1:5) |>
  ggplot(aes(x = State, y = prop_renewable)) +
  geom_col(color = "black", fill = "lightblue") +
  labs(title = "Top Five States for Renewable Energy consumption in 2019",
       y = "Renewable Energy Consumption in 2019 (Proportion)")

```

Here, we use a bar graph in order to compare each states renewable energy consumption in 2019.

Track these states over time:

```{r}
data |>
  filter(State == "California" |
         State == "District of Columbia" |
         State == "Hawaii" |
         State == "Massachusetts" |
         State == "Nevada") |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d()

```

This dot plot with lines of best fit allows us to better visualize how these states consumption of renewable energy has increased over time.

Metropolitan vs rural:

```{r}
metropolitan <- data |>
  filter(State == "California" |
         State == "District of Columbia" |
         State == "New York" |
         State == "Massachusetts" |
         State == "Texas") |>
  group_by(State)

rural <- data |>
filter(State == "Maine" |
         State == "Vermont" |
         State == "Mississippi" |
         State == "Montana" |
         State == "West Virginia") |>
  group_by(State)

```

```{r}
metropolitan |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Most Metropolitan States")
```

```{r}
rural |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Most Rural States")


```

This dot plot with lines of best fit shows the 5 states with the lowest renewable energy consumption, and allows us to see how their consumption of renewable energy has changed over time.

Geographical location:

```{r}
south <- data |>
filter(State == "Alabama" |
         State == "Georgia" |
         State == "Mississippi" |
         State == "Texas" |
         State == "Louisiana" |
         State == "Oklahoma" |
         State == "Arkansas" |
         State == "South Carolina") |>
  group_by(State)

northeast <- data |>
filter(State == "Maine" |
         State == "Massachusetts" |
         State == "Vermont" |
         State == "New Hampshire" |
         State == "Connecticut" |
         State == "Pennsylvania" |
         State == "New York" |
         State == "New Jersey" |
         State == "Maryland" | 
         State == "District of Columbia" |
         State == "Rhode Island" |
         State == "Delaware")|>
  group_by(State)

west <- data |>
filter(State == "California" |
         State == "Washington" |
         State == "Oregon" |
         State == "Colorado" |
         State == "Utah" |
         State == "Arizona" |
         State == "" |
         State == "Utah" )|>
  group_by(State)

midwest <- data |>
filter(State == "Montana" |
         State == "Minnesota" |
         State == "Nebraska" |
         State == "Kansas" |
         State == "Iowa" |
         State == "Missouri" |
         State == "Idaho" |
         State == "Illinois" |
         State == "Michigan")|>
  group_by(State)

south |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Southern States")

northeast |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in NE States")

west |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Western States")

midwest |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Midwest States")

```

These graphs allow us to both compare the different regions in the US, and within each region see how the consumption of renewable energy by state has changed over time. With this, we can analyze trends and patterns by region.

**Results** Our data confirms several important pieces of information. Primarily, renewable energy consumption since 1960 has overall increased significantly. Similarly, California, Washington D.C., Hawaii, Massachusetts, and Nevada use the highest proportion of renewable energy, with Hawaii having the highest proportion of the 5. Just like the nation as a whole, these states have seen a significant increase in renewable energy usage, sharply increasing in the early 2000s. When comparing metropolitan to rural areas, overall metropolitan areas have a much higher proportion of renewable energies compared to rural areas. Furthermore, metropolitan areas over the last years have increased their proportion of renewable energies, while rural areas have stayed stagnant or decreased. In terms of geographical location, the northeastern states by far have the highest proportion of renewable energy. The southern states, on the other hand, have the worst proportion of renewable energy.
