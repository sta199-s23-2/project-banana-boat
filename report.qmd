---
title: "Banana Boat STA 199 Project"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

## **Introduction & Data**

This data set comes from the CORGIS Dataset Project, who got this data from the US Energy Information Administration, a part of the US Government. This data has been collected by the US Energy Information Administration from 1960 to 2019 based on the consumption, production, expenditures, and price of different sources of energy by state.

The observations are of different states in different years and have variables for many energy sources, including coal, kerosene, geothermal, hydro, etc. There are also different variables for the production, consumption, expenditure, and price of these types of energy. For some of these, information was not available, in which case a 0 was reported.

There should be no ethical concerns about the data since the data is not specific to individuals and reports many types of used energy in the US.

*Research question: On both a state and national level, how has the proportion of renewable energy usage/production relative to overall energy usage/production changed over time, and has there been a shift in which states are the most renewable energy heavy?*

As climate change continues to progress rapidly, it is important to move towards clean technology and renewable energy sources in order to save our earth while ensuring innovation. The United States of America has emerged as a leading renewable energy innovator in the world, which is a perfect study target for researchers who are interested in the implementation of renewable energy. Our team thinks that analyzing the energy usage of different states is a good way to see how our country is progressing toward the goal of slowing global warming on a local level. This research method will help policymakers and environmental engineers pinpoint the specific problems regarding renewable energy in our country and help us move towards a clean future of collaboration of all states.

States that have higher emphasis on technological advancement such as California and North Carolina will see a significant increase in renewable energy production and consumption.

Important definitions: The data set contains both categorical and quantitative variables. The categorical variables include "State". The remaining columns, focusing on relevant facts regarding different uses of energy, are all quantitative.

Renewable energy: For our project, energy is considered renewable if it meets two criteria. First, the energy must be derived from a naturally occurring source. Additionally, the energy is naturally replenished at a higher rate than it is consumed/used.

Other energy sources: natural gas, coal, as well as any other sources of energy.

Groups of interest: states, expenditures and consumption of renewable energy and other energy sources, etc. Our goal is to study the effects of these aforementioned variables to learn about consumption habits and technological specialization of different states.

## **Literature Review**

Ratner, M., Bracmort, K., Brown, P., Campbell, R. J., Holt, M., Humphries, M., Pirog, R., & Yacobucci, B. D. (2018, November 5). U.S. Energy in the 21st Century: A Primer. The Congressional Research Service. Retrieved March 10, 2023, from https://crsreports.congress.gov/product/pdf/R/R46723

**Summary:** This article dives into energy usage in the United States and goes into detail about recent trends of energy usage. The text claims that, despite energy usage remaining relatively constant, the U.S. has shifted away from non-renewable energy sources (oil and coal) and towards more renewable sources of energy. The article makes the claim that natural gas and renewable energy consumption has increased, oil and nuclear power consumption didn't change and coal decreased. In the 21st century, renewable energy consumption has almost doubled, making its increasing importance obvious. Despite this, renewable energy still only makes up 11% of U.S. energy consumption.

**Difference from Research Question:** One big difference is that the article talks about general trends in the U.S. and does discuss any of the costs. Also, the article does not take into account the factors that could provide reasoning for differences in renewable energy usage by state, which we plan to look into.

## **Methodology**

```{r}
#| label: data-loading

library(tidyverse)
data <- read_csv("~/Final Project/data/energy.csv")
```

Creating variables total energy, total renewable energy, and proportion of renewable energy consumption:

```{r}
#| label: variables-generation

data <- data |>
  mutate(total_energy = Consumption.Commercial.Coal + 
                        `Consumption.Commercial.Distillate Fuel Oil` +
                        Consumption.Commercial.Geothermal +
                        Consumption.Commercial.Hydropower +
                        Consumption.Commercial.Kerosene +
                        Consumption.Commercial.Petroleum +
                        `Consumption.Commercial.Natural Gas` +
                        Consumption.Commercial.Solar +
                        Consumption.Commercial.Wind +
                        `Consumption.Electric Power.Coal` +
                        `Consumption.Electric Power.Distillate Fuel Oil` +
                        `Consumption.Electric Power.Natural Gas` +
                        Consumption.Industrial.Coal +
                        `Consumption.Industrial.Distillate Fuel Oil` +
                         Consumption.Industrial.Geothermal +
                         Consumption.Industrial.Hydropower +
                         Consumption.Industrial.Kerosene +
                         Consumption.Industrial.Petroleum +
                         `Consumption.Industrial.Natural Gas` +
                         `Consumption.Industrial.Other Petroleum Products` +
                         Consumption.Industrial.Solar +
                         Consumption.Industrial.Wind +
                         Consumption.Refinery.Coal +
                         Consumption.Refinery.Coal +
                         `Consumption.Residential.Distillate Fuel Oil` +
                         Consumption.Residential.Geothermal +
                         Consumption.Residential.Kerosene +
                         Consumption.Residential.Petroleum +
                         `Consumption.Residential.Natural Gas` +
                         Consumption.Transportation.Coal +
                         `Consumption.Transportation.Distillate Fuel Oil` +
                         Consumption.Transportation.Petroleum +
                         `Consumption.Transportation.Natural Gas`,
         .after = Year) |>
  mutate(total_renewable = Consumption.Commercial.Geothermal +
                           Consumption.Commercial.Hydropower +
                           Consumption.Commercial.Solar +
                           Consumption.Commercial.Wind +
                           Consumption.Industrial.Geothermal +
                           Consumption.Industrial.Hydropower +
                           Consumption.Industrial.Solar +
                           Consumption.Industrial.Wind +
                           Consumption.Residential.Geothermal,
         .after = total_energy) |>
  mutate(prop_renewable = (total_renewable / total_energy),
          .after = total_renewable)
```

Calculate total proportions for all states per year:

```{r}
#| label: total-proportion

national_renewable_usage <- data |>
  group_by(Year) |>
  summarize(total_energy_all_states = sum(total_energy),
            renewable_energy_all_states = sum(total_renewable)) |>
  mutate(prop_renewable_all_states = (renewable_energy_all_states / 
                                          total_energy_all_states))
```

Graph national usage of renewable energy:

```{r}
#| label: renew-energy-graph

national_renewable_usage |>
  ggplot(aes(x = Year, y = prop_renewable_all_states)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  labs(title = "National Renewable Consumption over Time",
       y = "Proportion of Renewable Energy Consumption")
```

Here, we use a dot plot to demonstrate the change over time of renewable consumption. Additionally, we added a line of best fit in order to best see how the consumption changed over time. It is important to note here that it would not make sense to fit a model here because the graph is not linear.

Here, we use a bar graph in order to compare each states renewable energy consumption in 2019.

Track these states over time:

``` {"}
```

Geographical location:

```{r}
#| label: geo-location

south <- data |>
filter(State == "Alabama" |
         State == "Georgia" |
         State == "Mississippi" |
         State == "Texas" |
         State == "Louisiana" |
         State == "Oklahoma" |
         State == "Arkansas" |
         State == "South Carolina") |>
  group_by(State)

northeast <- data |>
filter(State == "Maine" |
         State == "Massachusetts" |
         State == "Vermont" |
         State == "New Hampshire" |
         State == "Connecticut" |
         State == "Pennsylvania" |
         State == "New York" |
         State == "New Jersey" |
         State == "Maryland" | 
         State == "District of Columbia" |
         State == "Rhode Island" |
         State == "Delaware")|>
  group_by(State)

west <- data |>
filter(State == "California" |
         State == "Washington" |
         State == "Oregon" |
         State == "Colorado" |
         State == "Utah" |
         State == "Arizona" |
         State == "" |
         State == "Utah") |>
  group_by(State)

midwest <- data |>
filter(State == "Montana" |
         State == "Minnesota" |
         State == "Nebraska" |
         State == "Kansas" |
         State == "Iowa" |
         State == "Missouri" |
         State == "Idaho" |
         State == "Illinois" |
         State == "Michigan")|>
  group_by(State)

south |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Southern States")

northeast |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in NE States")

west |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Western States")

midwest |>
  group_by(State) |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Midwest States"
```

**Interaction Model:**

Model proportion of national renewable energy vs time to predict proportion of renewable energy in the future.

```{r}
#| label: create-national-model
model_national <- linear_reg() |>
  set_engine("lm") |>
  fit(prop_renewable_all_states ~ Year, data = national_renewable_usage)

tidy(model_national)
```

$\widehat{prop\_renewable\_national} = -3.43e^{-2}+1.76e^{-5} * Year$

Interpret our model:

We estimate the proportion of renewable energy a state uses to increase $1.67e^{-05}$ every year.

Model fit:

```{r}
#| label: national-model-performance
glance(model_national)$r.squared
glance(model_national)$adj.r.squared
glance(model_national)$AIC
```

Predicting renewable energy proportions in 2030:

```{r}
#| label: predictions
predict(model_national, data.frame(Year = 2030))

```

Model proportion of renewable energy vs region and time to predict proportion of renewable energy in the future.

```{r}
#| label: create-region-variable
south_state <- c("Alabama", "Georgia", "Mississippi", "Texas", "Louisiana",
                 "Oklahoma", "Arkansas", "South Carolina")
northeast_state <- c("Maine", "Massachusetts", "Vermont", "New Hampshire", 
                     "Connecticut", "Pennsylvania", "New York", "New Jersey",
                     "Maryland", "District of Columbia", "Rhode Island", 
                     "Delaware")
west_state <- c("California", "Washington", "Oregon", "Colorado", "Utah",
                "Arizona", "", "Utah")
midwest_state <- c("Montana", "Minnesota", "Nebraska", "Kansas", "Iowa", 
                   "Missouri", "Idaho", "Illinois", "Michigan")

data <- data |>
  mutate(region = if_else(State %in% south_state,
                          "south", if_else(State %in% northeast_state, 
                                           "northeast", if_else(State %in%
                                                                  west_state,
                                                                "west",
                                                                if_else(
                                                                  State %in%
                                                                    midwest_state,
                                                                  "midwest",
                                                                  "none"
                                                                ))))) |>
  filter(region != "none")

```

```{r}
#| label: create-model
library(tidymodels)

model <- linear_reg() |>
  set_engine("lm") |>
  fit(prop_renewable ~ Year * region, data = data)

tidy(model)
```

$\widehat{prop\_renewable} = -5.05e^{-2}+2.57e^{-5} * Year + 1.34e^{-1}*northeast + 5.18e^{-2} * south + 6.55e^{-3} * west + 6.6e^{-5}*Year*northeast -2.65e^{-5}*Year*south -3.4e^{-6}*Year*west$

{1 if south; 0 if not} {1 if northeast; 0 if not} {1 if west; 0 if not}

Interpreting our model:

Holding region constant, we estimate the proportion of renewable energy a state uses to increase $2.57e^{-05}$ every year.

Holding year constant, we estimate the proportion of renewable energy a state uses to increase $0.07808661$ for the **Northeast** region

Holding year constant, we estimate the proportion of renewable energy a state uses to increase $-0.00450742$ for the **South** region.

Holding year constant, we estimate the proportion of renewable energy a state uses to increase $-0.04969127$ for the **West** region.

Holding year constant, we estimate the proportion of renewable energy a state uses to decrease $-0.05054079$ for the **Midwest** region.

Model fit:

```{r}
#| label: model-performance
glance(model)$r.squared
glance(model)$adj.r.squared
glance(model)$AIC
```

Predicting renewable energy proportions in 2030:

```{r}
#| label: predictions

predict(model, data.frame(Year = 2030, region = "west"))
predict(model, data.frame(Year = 2030, region = "south"))
predict(model, data.frame(Year = 2030, region = "northeast"))
predict(model, data.frame(Year = 2030, region = "midwest"))
```

**Political Affiliations:**

```{r}
#| label: political-datasets

democrat <- data |>
  filter(State == "California" |
         State == "Oregon" |
         State == "Washington" |
         State == "Nevada" |
         State == "Colorado" |
         State == "New Mexico" |
         State == "Minnesota" |
         State == "Iowa" |
         State == "Hawaii" |
         State == "Wisconsin" |
         State == "Illonois" |
         State == "Michigan" |
         State == "Florida" |
         State == "Virginia" |
         State == "Maryland" |
         State == "Delaware" |
         State == "Pennsylvania" |
         State == "New Jersey" |
         State == "New York" |
         State == "Massachussetts" |
         State == "Rhode Island" |
         State == "Connecticut" |
         State == "Vermont" |
         State == "New Hampshire" |
         State == "Maine") |>
  group_by(State)

republican <- data |>
filter(State == "Alaska" |
         State == "Idaho" |
         State == "Montana" |
         State == "Wyoming" |
         State == "North Dakota" | 
         State == "South Dakota" |
         State == "Nebraska" |
         State == "Kansas" |
         State == "Oklahoma" |
         State == "Texas" |
         State == "Missouri" |
         State == "Arkansas" |
         State == "Louisiana" |
         State == "Mississippi" |
         State == "Alabama" |
         State == "Tennessee" |
         State == "Kentucky" |
         State == "Indiana" |
         State == "Ohio" |
         State == "West Virginia" |
         State == "Georgia" |
         State == "South Carolina" |
         State == "North Carolina") |>
  group_by(State)
```

These states were grouped by democratic and republic based on how they voted in 2018 because this dataset ended in 2019, and 2018 was the most recent nationwide voting before that.

```{r}
#| label: deomcrat-graph

democrat |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Democratic States")
```

```{r}
#| label: republican-graph

republican |>
  ggplot(aes(x = Year, y = prop_renewable, color = State)) +
  geom_point(alpha = 0.5) +
  scale_color_viridis_d() +
  geom_smooth(se = FALSE) +
  scale_color_viridis_d() +
  labs(y = "Proportion of Energy from Renewable Sources", 
       x = "Year", title = "Energy in Republican States")
```

By comparing these two graphs, we can see that the democratic states overall use a higher proportion of renewable energy than the republican states. Most of the republican states have been slightly increasing since 2000, but have still most of them in 2019 ranged from a proportion of 0.000 to 0.002, with most states being around 0.001 and Idaho being an outlier at a proportion of 0.004. The democratic states, on the other hand, range from 0.00 to 0.008, with most states being around 0.003. While these both have very lower porportions of renewable energy, the democratic states on average have a higher proportional of renewable energy than the republican states.

```{r}
#| label: political-variables

democrat_state <- c("California", "Oregon", "Washington", "Nevada", 
                      "Colorado", "New Mexico", "Minnesota", "Iowa", 
                      "Hawaii", "Wisconsin", "Illonois", "Michigan", 
                      "Florida", "Virginia", "Maryland", "Delaware", 
                      "Pennsylvania", "New Jersey", "New York", 
                      "Massachussetts", "Rhode Island", "Connecticut", 
                      "Vermont", "New Hampshire", "Maine")
  

republican_state <- c("Alaska", "Idaho", "Montana", "Wyoming", "North Dakota",
                      "South Dakota", "Nebraska", "Kansas", "Oklahoma",
                      "Texas", "Missouri", "Arkansas", "Louisiana",
                      "Mississippi", "Alabama", "Tennessee", "Kentucky",
                      "Indiana", "Ohio", "West Virginia", "Georgia",
                      "South Carolina", "North Carolina")
```

```{r}
#| label: political-model-data

data_political <- data |>
  mutate(party = if_else(State == democrat_state, 
                           "Democratic State", 
                           "Republican State"))
```

```{r}
#| label: political-model

model_political <- linear_reg() |>
  set_engine("lm") |>
  fit(prop_renewable ~ Year * party, data = data_political)

tidy(model_political)
```

\$\\widehat{prop\\\_renewable}=-1.41e\^{-2}+8.54e\^{-6}+1.85e\^{-2}\*Republican State - -9.92e\^{-6}\*Year\*Republican State\$

{1 if Republican state; 0 if Democratic state}

Holding region constant, we estimate the proportion of renewable energy a state uses to increase \$8.54e\^{-05}\$ every year.

Holding year constant, we estimate the proportion of renewable energy a state uses to increase \$0.01847306\$ for the Democratic states.

Holding year constant, we estimate the proportion of renewable energy a state uses to increase \$-0.014067232\$ for the Republican states.

```{r}
#| label: political-r-squared

glance(model_political)$r.squared
glance(model_political)$adj.r.squared
glance(model_political)$AIC
```

The R squared and adjusted R squared for this model is very low, meaning that it is not a very good model for determining use of renewable energy. The AIC further confirms it by showing that there are many other explanatory variables. Therefore, although it is likely that political party plays a part in the use of renewable energy, there are many other factors that play an important part.

**Results** Our data confirms several important pieces of information. Primarily, renewable energy consumption since 1960 has overall increased significantly. Similarly, California, Washington D.C., Hawaii, Massachusetts, and Nevada use the highest proportion of renewable energy, with Hawaii having the highest proportion of the 5. Just like the nation as a whole, these states have seen a significant increase in renewable energy usage, sharply increasing in the early 2000s. When comparing metropolitan to rural areas, overall metropolitan areas have a much higher proportion of renewable energies compared to rural areas. Furthermore, metropolitan areas over the last years have increased their proportion of renewable energies, while rural areas have stayed stagnant or decreased. In terms of geographical location, the northeastern states by far have the highest proportion of renewable energy. The southern states, on the other hand, have the worst proportion of renewable energy.
